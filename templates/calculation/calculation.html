{% extends "main/layout.html" %}
{% block title %}Расчет{% endblock title %}
{% block content %}
    <body>
    <h4>Для начала расчета выберите защищаемую ЛЭП</h4>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Подтвердить</button>
    </form>
    {% if selected_line %}
        <p><strong>Выбранная ЛЭП: </strong>{{ selected_line_data.dispatch_name }}</p>
        <p><strong>Наименование ЛЭП в PowerFactory: </strong>{{ selected_line_data.pf_name }}</p>
        <p><strong>ДДТН, А: </strong>{{ selected_line_data.current_capacity }}</p>
        <p><strong>Длина, км: </strong>{{ selected_line_data.length }}</p>
        <p><strong>Подстанции ЛЭП:</strong></p>
        {% for protection_half_set in protection_half_sets %}
            <ul>
                <li>{{ protection_half_set.substation }}</li>
            </ul>
        {% endfor %}
        <p><strong>Модель устройства РЗА: </strong>{{ protection_half_sets.0.protection_device }}</p>
        <p><strong>Производитель: </strong>{{ protection_half_sets.0.protection_device.manufacturer }}</p>
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="line" value="{{ selected_line.id }}">
            <button type="submit" name="run_calculation">Выполнить расчет</button>
        </form>
    {% endif %}
    </body>
{% endblock content %}